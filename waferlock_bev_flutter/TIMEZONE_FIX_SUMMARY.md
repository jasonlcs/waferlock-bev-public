# ğŸŒ æ™‚å€è½‰æ›ä¿®æ­£ç¸½çµ

## âœ… å·²å®Œæˆçš„æ”¹å–„

### 1. UTC æ™‚é–“è‡ªå‹•è½‰æ›ç‚ºæœ¬åœ°æ™‚é–“

#### å•é¡Œ
- API å›å‚³çš„ `eventTime` æ˜¯ **UTC æ™‚é–“**
- ç›´æ¥é¡¯ç¤ºæœƒèˆ‡æœ¬åœ°æ™‚é–“ç›¸å·® 8 å°æ™‚ï¼ˆå°ç£ UTC+8ï¼‰

#### è§£æ±ºæ–¹æ¡ˆ
åœ¨ `ConsumptionRecord.fromJson()` ä¸­è‡ªå‹•è½‰æ›ï¼š

```dart
// è§£æ UTC æ™‚é–“
final utcTimestamp = DateTime.parse(json['eventTime']);

// è½‰æ›ç‚ºæœ¬åœ°æ™‚å€
final localTimestamp = utcTimestamp.toLocal();
```

#### è½‰æ›ç¯„ä¾‹
```
API å›å‚³ (UTC):     2024-11-04 07:00:00Z
è½‰æ›å¾Œ (UTC+8):     2024-11-04 15:00:00
```

### 2. é¡¯ç¤ºæ™‚å€æ¨™ç¤º

#### åœ¨æ¶ˆè²»è¨˜éŒ„è¡¨æ ¼æ¨™é¡Œæ–°å¢æ™‚å€æŒ‡ç¤ºå™¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ¶ˆè²»è¨˜éŒ„      ğŸ• æœ¬åœ°æ™‚é–“ (UTC+8)   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ™‚é–“          å“å        åƒ¹æ ¼      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ç‰¹é»
- âœ… è‡ªå‹•åµæ¸¬ç³»çµ±æ™‚å€
- âœ… é¡¯ç¤ºæ™‚å€åç§»é‡ï¼ˆå¦‚ UTC+8ï¼‰
- âœ… è—è‰²æ¨™ç±¤ï¼Œæ¸…æ¥šæ˜“è¾¨è­˜
- âœ… åŒ…å«æ™‚é˜åœ–ç¤º

### 3. è‡ªå‹•åµæ¸¬ç³»çµ±æ™‚å€

#### æŠ€è¡“å¯¦ä½œ
```dart
final now = DateTime.now();
final offsetHours = now.timeZoneOffset.inHours;
final offsetMinutes = now.timeZoneOffset.inMinutes.remainder(60);
final timeZoneStr = 'UTC${offsetHours >= 0 ? '+' : ''}$offsetHours';
```

#### æ”¯æ´çš„æ™‚å€æ ¼å¼
- `UTC+8` (å°ç£ã€é¦™æ¸¯ã€æ–°åŠ å¡)
- `UTC+9` (æ—¥æœ¬ã€éŸ“åœ‹)
- `UTC-5` (ç¾åœ‹æ±å²¸)
- `UTC-8` (ç¾åœ‹è¥¿å²¸)
- `UTC+0` (è‹±åœ‹ GMT)
- ç­‰...

## ğŸ”§ æŠ€è¡“ç´°ç¯€

### DateTime æ™‚å€è™•ç†

#### UTC æ™‚é–“
```dart
DateTime.parse('2024-11-04T07:00:00Z')  // Z è¡¨ç¤º UTC
```

#### è½‰æ›ç‚ºæœ¬åœ°æ™‚é–“
```dart
utcTime.toLocal()  // è‡ªå‹•è½‰æ›ç‚ºç³»çµ±æ™‚å€
```

#### å–å¾—æ™‚å€åç§»
```dart
DateTime.now().timeZoneOffset
// å›å‚³ Duration(hours: 8) for UTC+8
```

### æ™‚å€æ¨™ç¤ºå…ƒä»¶

```dart
Container(
  padding: EdgeInsets.symmetric(horizontal: 8, vertical: 4),
  decoration: BoxDecoration(
    color: Colors.blue.shade50,
    borderRadius: BorderRadius.circular(4),
    border: Border.all(color: Colors.blue.shade200),
  ),
  child: Row(
    children: [
      Icon(Icons.schedule, size: 14),
      Text('æœ¬åœ°æ™‚é–“ (UTC+8)'),
    ],
  ),
)
```

## ğŸ“Š æ™‚å€è½‰æ›æµç¨‹

```
API å›æ‡‰
    â†“
è§£æ UTC æ™‚é–“
    â†“
DateTime.parse('2024-11-04T07:00:00Z')
    â†“
è½‰æ›ç‚ºæœ¬åœ°æ™‚å€
    â†“
utcTime.toLocal()
    â†“
2024-11-04 15:00:00 (UTC+8)
    â†“
é¡¯ç¤ºåœ¨ UI
```

## ğŸŒ å„åœ°æ™‚å€ç¯„ä¾‹

### å°ç£æ™‚é–“ (UTC+8)
```
UTC:   2024-11-04 07:00:00
Local: 2024-11-04 15:00:00
```

### æ—¥æœ¬æ™‚é–“ (UTC+9)
```
UTC:   2024-11-04 07:00:00
Local: 2024-11-04 16:00:00
```

### ç¾åœ‹è¥¿å²¸ (UTC-8)
```
UTC:   2024-11-04 07:00:00
Local: 2024-11-03 23:00:00
```

### è‹±åœ‹æ™‚é–“ (UTC+0)
```
UTC:   2024-11-04 07:00:00
Local: 2024-11-04 07:00:00
```

## ğŸ¯ ä½¿ç”¨è€…é«”é©—æ”¹å–„

### Before (ä¹‹å‰)
âŒ é¡¯ç¤º UTC æ™‚é–“ï¼Œèˆ‡æœ¬åœ°æ™‚é–“ä¸ç¬¦
âŒ æ²’æœ‰æ™‚å€æ¨™ç¤ºï¼Œä½¿ç”¨è€…å›°æƒ‘
âŒ éœ€è¦æ‰‹å‹•æ›ç®—æ™‚é–“

### After (ç¾åœ¨)
âœ… è‡ªå‹•é¡¯ç¤ºæœ¬åœ°æ™‚é–“
âœ… æ¸…æ¥šæ¨™ç¤ºæ™‚å€ (UTC+8)
âœ… æ™‚é–“æº–ç¢ºï¼Œç¬¦åˆä½¿ç”¨è€…ç¿’æ…£

## ğŸ“± å¹³å°æ”¯æ´

### è‡ªå‹•æ™‚å€åµæ¸¬
- âœ… iOS - ä½¿ç”¨ç³»çµ±æ™‚å€è¨­å®š
- âœ… Android - ä½¿ç”¨ç³»çµ±æ™‚å€è¨­å®š
- âœ… Web - ä½¿ç”¨ç€è¦½å™¨æ™‚å€è¨­å®š
- âœ… macOS - ä½¿ç”¨ç³»çµ±æ™‚å€è¨­å®š
- âœ… Windows - ä½¿ç”¨ç³»çµ±æ™‚å€è¨­å®š
- âœ… Linux - ä½¿ç”¨ç³»çµ±æ™‚å€è¨­å®š

### å¤ä»¤æ™‚é–“ (DST) æ”¯æ´
Flutter çš„ `DateTime.toLocal()` æœƒè‡ªå‹•è™•ç†å¤ä»¤æ™‚é–“è½‰æ›ã€‚

## ğŸ§ª æ¸¬è©¦æ–¹æ³•

### æ¸¬è©¦æ™‚å€è½‰æ›
```dart
// 1. å»ºç«‹ UTC æ™‚é–“
final utc = DateTime.parse('2024-11-04T07:00:00Z');
print('UTC: $utc');

// 2. è½‰æ›ç‚ºæœ¬åœ°æ™‚é–“
final local = utc.toLocal();
print('Local: $local');

// 3. æª¢æŸ¥æ™‚å€åç§»
final offset = DateTime.now().timeZoneOffset;
print('Offset: $offset');
```

### æ¸¬è©¦ä¸åŒæ™‚å€
```bash
# macOS/Linux - æš«æ™‚æ”¹è®Šæ™‚å€
TZ="Asia/Tokyo" flutter run -d chrome
TZ="America/New_York" flutter run -d chrome
TZ="Europe/London" flutter run -d chrome
```

### é©—è­‰é¡¯ç¤º
1. æŸ¥çœ‹æ¶ˆè²»è¨˜éŒ„è¡¨æ ¼
2. ç¢ºèªæ¨™é¡Œé¡¯ç¤º "æœ¬åœ°æ™‚é–“ (UTC+X)"
3. ç¢ºèªæ™‚é–“èˆ‡ç³»çµ±æ™‚é–“ä¸€è‡´

## ğŸ” é™¤éŒ¯æŠ€å·§

### æª¢è¦–åŸå§‹ UTC æ™‚é–“
```dart
print('API Response: ${json['eventTime']}');
print('UTC: ${DateTime.parse(json['eventTime'])}');
print('Local: ${DateTime.parse(json['eventTime']).toLocal()}');
```

### æª¢è¦–æ™‚å€è³‡è¨Š
```dart
final now = DateTime.now();
print('Local Time: $now');
print('UTC Time: ${now.toUtc()}');
print('Timezone Offset: ${now.timeZoneOffset}');
print('Timezone Name: ${now.timeZoneName}');
```

## ğŸ“‹ æ›´æ–°çš„æª”æ¡ˆ

1. âœ… `lib/models/consumption_record.dart`
   - æ–°å¢ UTC è½‰æœ¬åœ°æ™‚é–“é‚è¼¯
   
2. âœ… `lib/widgets/results_display_widget.dart`
   - æ–°å¢æ™‚å€æ¨™ç¤ºå…ƒä»¶
   - é¡¯ç¤ºç³»çµ±æ™‚å€åç§»é‡

## ğŸ¨ è¦–è¦ºæ•ˆæœ

### æ™‚å€æ¨™ç¤ºæ¨£å¼
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ• æœ¬åœ°æ™‚é–“ (UTC+8)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- **èƒŒæ™¯è‰²**: æ·ºè—è‰² (Colors.blue.shade50)
- **é‚Šæ¡†**: è—è‰² (Colors.blue.shade200)
- **åœ–ç¤º**: æ™‚é˜ (Icons.schedule)
- **æ–‡å­—**: æ·±è—è‰²ï¼Œç²—é«”
- **ä½ç½®**: æ¶ˆè²»è¨˜éŒ„è¡¨æ ¼æ¨™é¡Œå³å´

## âœ¨ å®Œæˆç‹€æ…‹

âœ… **UTC è‡ªå‹•è½‰æœ¬åœ°æ™‚é–“**
âœ… **è‡ªå‹•åµæ¸¬ç³»çµ±æ™‚å€**
âœ… **é¡¯ç¤ºæ™‚å€æ¨™ç¤º**
âœ… **æ”¯æ´æ‰€æœ‰å¹³å°**
âœ… **æ”¯æ´å¤ä»¤æ™‚é–“**
âœ… **Flutter Analyze: No issues found!**

## ğŸ‰ ç¾åœ¨çš„è¡Œç‚º

1. **API å›å‚³ UTC æ™‚é–“** â†’ è‡ªå‹•è½‰æ›
2. **ç³»çµ±æ™‚å€ UTC+8** â†’ é¡¯ç¤º +8 å°æ™‚
3. **æ¶ˆè²»è¨˜éŒ„è¡¨æ ¼** â†’ æ¨™ç¤ºã€Œæœ¬åœ°æ™‚é–“ (UTC+8)ã€
4. **å…¶ä»–æ™‚å€** â†’ è‡ªå‹•é©æ‡‰

æ™‚é–“é¡¯ç¤ºç¾åœ¨å®Œå…¨æº–ç¢ºäº†ï¼ğŸ•âœ¨
